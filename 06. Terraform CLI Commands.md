# 🧠 **SOP: Terraform CLI Commands Deep Dive** 💻⚙️

---

## 🎯 **Goal**

By the end of this SOP, you’ll:
✅ Understand **all essential Terraform CLI commands**
✅ Know **when and why** to use each
✅ Build confidence in automation, troubleshooting & CI/CD

---

## 🚀 **Why This Matters**

Terraform isn’t just about writing `.tf` files — the **CLI commands** are what bring your infrastructure to life.
Mastering them helps you:

* Automate deployments in pipelines 🤖
* Debug configuration issues 🐛
* Manage state and changes safely 🧩

---

## 📘 **Top Terraform CLI Commands (with Use Cases)**

| 🔢     | Command                           | 🧩 Description                                            | 💡 Use Case                                            |
| ------ | --------------------------------- | --------------------------------------------------------- | ------------------------------------------------------ |
| 1️⃣    | `terraform init`                  | Initializes Terraform in a new directory                  | Downloads provider plugins (AWS, GCP, Azure)           |
| 2️⃣    | `terraform validate`              | Validates configuration syntax                            | Catch errors before planning                           |
| 3️⃣    | `terraform fmt`                   | Formats Terraform code                                    | Keeps code clean and standardized                      |
| 4️⃣    | `terraform plan`                  | Previews what Terraform will do                           | Shows what resources will be created/changed/destroyed |
| 5️⃣    | `terraform apply`                 | Executes the plan                                         | Actually creates or updates infrastructure             |
| 6️⃣    | `terraform destroy`               | Tears down infrastructure                                 | Clean up everything safely                             |
| 7️⃣    | `terraform show`                  | Displays current state or plan                            | View what Terraform manages right now                  |
| 8️⃣    | `terraform output`                | Displays output variables                                 | Useful in pipelines and module chaining                |
| 9️⃣    | `terraform state list`            | Lists resources in the state file                         | Verify Terraform is tracking your infra correctly      |
| 🔟     | `terraform state show <resource>` | Shows details of a tracked resource                       | Inspect live resource attributes                       |
| 1️⃣1️⃣ | `terraform refresh`               | Updates local state with real cloud state                 | Syncs Terraform with reality                           |
| 1️⃣2️⃣ | `terraform import`                | Brings an existing cloud resource under Terraform control | Manage manually created resources                      |
| 1️⃣3️⃣ | `terraform taint`                 | Marks a resource for recreation on next apply             | Force rebuild of broken resources                      |
| 1️⃣4️⃣ | `terraform untaint`               | Removes the taint flag                                    | Skip unnecessary recreation                            |
| 1️⃣5️⃣ | `terraform graph`                 | Creates dependency graph                                  | Visualize infrastructure relationships                 |
| 1️⃣6️⃣ | `terraform workspace`             | Manage multiple environments (dev/stage/prod)             | Switch between envs without rewriting code             |

---

## 🧱 **Step-by-Step Practical Demo**

---

### 🥇 Step 1: Initialize Terraform 🧰

```bash
terraform init
```

✅ Downloads providers and sets up backend.

💡 *Always the first command after writing your `.tf` files.*

---

### 🥈 Step 2: Format & Validate 🧼✅

```bash
terraform fmt
terraform validate
```

✅ Keeps code clean and free of syntax errors.
💡 Essential before committing to Git or running in pipelines.

---

### 🥉 Step 3: Preview Plan 🗺️

```bash
terraform plan -out=tfplan.out
```

✅ Shows what will change.
💡 Saves plan output to a file for later use (great for approvals).

---

### 🏗️ Step 4: Apply Changes ⚙️

```bash
terraform apply tfplan.out
```

✅ Deploys your infrastructure.
💡 Use `-auto-approve` for automation (CI/CD).

---

### 💣 Step 5: Destroy Resources 🧹

```bash
terraform destroy -auto-approve
```

✅ Removes all Terraform-managed resources.
💡 Best practice after testing — saves cloud costs.

---

### 🧩 Step 6: Check State 🗃️

```bash
terraform show
terraform state list
terraform state show aws_instance.myec2
```

✅ Understand what Terraform currently controls.
💡 Helps in debugging drift or dependency issues.

---

### 🔄 Step 7: Refresh State 🌍

```bash
terraform refresh
```

✅ Updates state to match the actual cloud environment.
💡 Useful if resources were manually changed outside Terraform.

---

### 🧬 Step 8: Workspaces (Multi-Environment Setup) 🌱

```bash
terraform workspace new dev
terraform workspace select dev
terraform workspace list
```

✅ Manage multiple environments (dev/stage/prod) using one configuration.
💡 Keeps isolated state files for each environment.

---

## 🧾 **Summary Table**

| Step | Command                      | Purpose        | Use Case                 |
| ---- | ---------------------------- | -------------- | ------------------------ |
| 🥇   | `terraform init`             | Initialize     | Setup project directory  |
| 🥈   | `terraform fmt` + `validate` | Format + Check | Code hygiene             |
| 🥉   | `terraform plan`             | Preview        | Safe deployment planning |
| 🏗️  | `terraform apply`            | Deploy         | Execute infra changes    |
| 💣   | `terraform destroy`          | Cleanup        | Remove infra             |
| 🧩   | `terraform state` cmds       | Inspect        | Debug state issues       |
| 🔄   | `terraform refresh`          | Sync           | Update local state       |
| 🧬   | `terraform workspace`        | Environments   | Manage multiple setups   |

---

## ⚙️ **Real DevOps Use Case Example**

In a **CI/CD pipeline (e.g., GitHub Actions or Jenkins)**:

```bash
terraform fmt -check
terraform validate
terraform plan -out=tfplan.out
terraform apply -auto-approve tfplan.out
```

✅ This ensures:

* Clean & validated code
* Controlled deployment
* Fully automated pipeline flow

---

## 🔥 **Bonus Commands**

| Command               | Description                                        |
| --------------------- | -------------------------------------------------- |
| `terraform version`   | Check installed Terraform version                  |
| `terraform providers` | List required and installed providers              |
| `terraform console`   | Interactively evaluate Terraform expressions       |
| `terraform lock`      | Manage dependency lock files for consistent builds |

---

## 🧩 **Output Example**

```
Terraform v1.9.5
Initializing provider plugins...
Success! Terraform has been successfully initialized!
Plan: 1 to add, 0 to change, 0 to destroy.
Apply complete! Resources: 1 added, 0 changed, 0 destroyed.
```

---

## 🧠 **Key Takeaways**

✅ Learn **every CLI command** — these are your DevOps “weapons.”
✅ Use them regularly to **debug, automate, and deploy safely.**
✅ Combine them in **pipelines** for powerful, hands-off infrastructure workflows.

--
